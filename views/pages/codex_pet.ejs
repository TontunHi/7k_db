<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('../partials/head') %>
    <style>
        /* Pet Theme (Greenish) */
        body { background-color: #0b0c10; color: #c5c6c7; font-family: 'Segoe UI', sans-serif; padding-top: 70px; }
        .codex-container { display: flex; min-height: calc(100vh - 70px); }
        .sidebar { width: 260px; background: #1f2833; border-right: 1px solid #45a29e; flex-shrink: 0; display: flex; flex-direction: column; }
        .content-area { flex: 1; padding: 20px; background: #0b0c10; overflow-y: auto; }
        
        .group-item { padding: 12px 20px; color: #c5c6c7; text-decoration: none; display: flex; justify-content: space-between; align-items: center; border-left: 3px solid transparent; transition: 0.2s; }
        .group-item:hover { background: #2c353f; color: #2ecc71; }
        .group-item.active { background: #2c353f; color: #2ecc71; border-left-color: #2ecc71; font-weight: 600; }
        .sidebar-title { padding: 20px; font-weight: bold; color: #2ecc71; border-bottom: 1px solid #45a29e; margin-bottom: 10px; }

        .nav-pills .nav-link { color: #888; border-radius: 50px; padding: 8px 20px; font-weight: 500; transition: 0.3s; border: 1px solid #333; margin-right: 8px; }
        .nav-pills .nav-link:hover { color: #fff; border-color: #2ecc71; background: rgba(46, 204, 113, 0.1); }
        .nav-pills .nav-link.active { background-color: #2ecc71; color: #000; font-weight: bold; border-color: #2ecc71; box-shadow: 0 0 10px rgba(46, 204, 113, 0.4); }

        .hero-card { background: #1f2833; border: 1px solid #2f3a46; border-radius: 12px; overflow: hidden; transition: 0.3s; cursor: pointer; }
        .hero-card:hover { transform: translateY(-5px); border-color: #2ecc71; box-shadow: 0 5px 15px rgba(46, 204, 113, 0.2); }
        .hero-img-wrapper { aspect-ratio: 3/4; overflow: hidden; }
        .hero-img { width: 100%; height: 100%; object-fit: cover; transition: 0.3s; }
        .hero-card:hover .hero-img { transform: scale(1.05); }
        .hero-info { padding: 12px; text-align: center; }
        .hero-name { color: #fff; font-weight: 600; font-size: 1rem; margin: 0; }
    </style>
</head>
<body>
    
    <%- include('../partials/navbar') %>

    <div class="codex-container">
        <div class="sidebar d-none d-md-flex">
            <div class="sidebar-title"><i class="bi bi-github me-2"></i>PET GROUPS</div>
            <div class="overflow-auto flex-grow-1">
                <% if(groups.length > 0) { %>
                    <% groups.forEach(grp => { %>
                        <a href="/codex/pet?cat_id=<%= activeCatId %>&group_id=<%= grp.id %>" 
                           class="group-item <%= activeGroupId == grp.id ? 'active' : '' %>">
                           <%= grp.name %> <i class="bi bi-chevron-right small opacity-50"></i>
                        </a>
                    <% }) %>
                <% } else { %>
                    <div class="p-3 text-muted text-center">No Groups</div>
                <% } %>
            </div>
        </div>

        <div class="content-area">
            <div class="d-md-none mb-3">
                <select class="form-select bg-dark text-white border-secondary" onchange="window.location.href=this.value">
                    <% groups.forEach(grp => { %>
                        <option value="/codex/pet?cat_id=<%= activeCatId %>&group_id=<%= grp.id %>" <%= activeGroupId == grp.id ? 'selected' : '' %>>
                            <%= grp.name %>
                        </option>
                    <% }) %>
                </select>
            </div>

            <ul class="nav nav-pills mb-4 pb-2 border-bottom border-secondary">
                <% categories.forEach(cat => { %>
                    <li class="nav-item">
                        <a class="nav-link <%= activeCatId == cat.id ? 'active' : '' %>" href="/codex/pet?cat_id=<%= cat.id %>"><%= cat.name %></a>
                    </li>
                <% }) %>
            </ul>

            <div class="container-fluid p-0">
                <% if(pets.length > 0) { %>
                    <h4 class="text-white mb-4 fw-bold border-start border-4 border-success ps-3">
                        <%= groups.find(g => g.id == activeGroupId)?.name || 'Pets' %>
                    </h4>
                    <div class="row g-4">
                        <% pets.forEach(pet => { %>
                            <div class="col-6 col-sm-4 col-md-3 col-lg-2">
                                <div class="hero-card">
                                    <div class="hero-img-wrapper">
                                        <img src="/images/pets/<%= pet.image_name %>" class="hero-img" loading="lazy">
                                    </div>
                                    <div class="hero-info">
                                        <h6 class="hero-name"><%= pet.name %></h6>
                                    </div>
                                </div>
                            </div>
                        <% }) %>
                    </div>
                <% } else { %>
                    <div class="text-center py-5 text-muted border border-secondary border-dashed rounded mt-4">
                        <i class="bi bi-search display-4 mb-3 d-block opacity-50"></i>
                        <h5>No Pets found</h5>
                    </div>
                <% } %>
            </div>
        </div>
    </div>

    <%- include('../partials/footer') %>
</body>
</html>